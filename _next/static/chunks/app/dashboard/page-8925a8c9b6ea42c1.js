(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{4260:function(e,t,n){Promise.resolve().then(n.bind(n,1720))},1720:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var r=n(7437),a=n(575),u=n(9376),i=n(2265);function l(){let{currentUser:e,loading:t}=(0,a.a)(),n=(0,u.useRouter)();return(0,i.useEffect)(()=>{!t&&e?n.push("/dashboard/".concat(e.role)):t||e||n.push("/login")},[e,t,n]),(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}},575:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return d},a:function(){return o}});var r=n(7437),a=n(2265),u=n(3301),i=n(5978),l=n(4257);let s=(0,a.createContext)(void 0);function o(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function d(e){let{children:t}=e,[n,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[m,f]=(0,a.useState)(!0);(0,a.useEffect)(()=>(0,u.Aj)(l.I8,async e=>{if(c(e),e){let t=await (0,i.QT)((0,i.JU)(l.db,"users",e.uid));t.exists()?o(t.data()):o(null)}else o(null);f(!1)}),[]);let b=async(e,t)=>{await (0,u.e5)(l.I8,e,t)},p=async(e,t,n)=>{let{user:r}=await (0,u.Xb)(l.I8,e,t),a={uid:r.uid,email:e,name:n.name||"",role:n.role||"student",registrationNumber:n.registrationNumber,employeeId:n.employeeId,mobileNumber:n.mobileNumber,department:n.department,branch:n.branch,section:n.section,year:n.year,createdAt:(0,i.Bt)()};await (0,i.pl)((0,i.JU)(l.db,"users",r.uid),a),o(a)},h=async()=>{let e=new u.hJ,t=await (0,u.rh)(l.I8,e),n=await (0,i.QT)((0,i.JU)(l.db,"users",t.user.uid)),r=!n.exists();return r||o(n.data()),{isNewUser:r}},y=async()=>{await (0,u.w7)(l.I8),o(null),c(null)},v=async e=>{if(!d)throw Error("No user logged in");let t={...e,updatedAt:(0,i.Bt)()};if(await (0,i.pl)((0,i.JU)(l.db,"users",d.uid),t,{merge:!0}),"faculty"===(e.role||(null==n?void 0:n.role))){let t=e.department||(null==n?void 0:n.department);if(t){let r=(0,i.JU)(l.db,"admin","faculty","branch",t),a=(0,i.JU)(r,"faculty_members",d.uid);await (0,i.pl)(r,{name:t,updatedAt:(0,i.Bt)()},{merge:!0}),await (0,i.pl)(a,{uid:d.uid,name:e.name||(null==n?void 0:n.name)||"",email:d.email,employeeId:e.employeeId||(null==n?void 0:n.employeeId)||"",mobileNumber:e.mobileNumber||(null==n?void 0:n.mobileNumber)||"",department:t,joinedAt:(0,i.Bt)()},{merge:!0})}}o(t=>t?{...t,...e}:null)};return(0,r.jsx)(s.Provider,{value:{currentUser:n,firebaseUser:d,loading:m,signIn:b,signUp:p,signInWithGoogle:h,signOut:y,updateUserProfile:v},children:t})}},4257:function(e,t,n){"use strict";n.d(t,{I8:function(){return o},db:function(){return d}});var r=n(738),a=n(3301),u=n(5978),i=n(7292),l=n(62);let s=0===(0,r.C6)().length?(0,r.ZF)({apiKey:"AIzaSyCriF-OZFtI_SocDqx3FGo3XP_txugfLk8",authDomain:"alietake.firebaseapp.com",projectId:"alietake",storageBucket:"alietake.firebasestorage.app",messagingSenderId:"443363656423",appId:"1:443363656423:web:39544e219f609ab9f1d842",measurementId:"G-23NJJ85VQZ",databaseURL:"https://alietake.firebaseio.com"}):(0,r.Mq)(),o=(0,a.v0)(s),d=(0,u.ad)(s);(0,i.N8)(s),(0,l.cF)(s),n.e(834).then(n.bind(n,6834)).then(e=>{e.getAnalytics(s)})},9376:function(e,t,n){"use strict";var r=n(5475);n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})}},function(e){e.O(0,[358,481,139,379,971,117,744],function(){return e(e.s=4260)}),_N_E=e.O()}]);